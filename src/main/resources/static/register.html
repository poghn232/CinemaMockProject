<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Đăng ký | MovieZone</title>

    <style>
        body {
            font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background:
                    radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.08), transparent 50%),
                    radial-gradient(circle at 100% 100%, rgba(255, 255, 255, 0.05), transparent 55%),
                    linear-gradient(135deg, #050816, #0b1220 50%, #020617);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            color: #e5e7eb;
            overflow: hidden;
        }

        .backdrop-blur {
            position: fixed;
            inset: 0;
            background:
                    linear-gradient(to right, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.7)),
                    url("https://images.pexels.com/photos/7991377/pexels-photo-7991377.jpeg?auto=compress&cs=tinysrgb&w=1600")
                    center/cover no-repeat;
            filter: brightness(0.9);
            z-index: -1;
        }

        .register-wrapper {
            display: grid;
            grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
            gap: 60px;
            width: min(1000px, 100% - 64px);
            align-items: center;
        }

        @media (max-width: 820px) {
            .register-wrapper {
                grid-template-columns: 1fr;
                gap: 32px;
            }
        }

        .brand-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .brand-logo {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            font-size: 14px;
            color: #e5e7eb;
        }

        .brand-logo span {
            width: 26px;
            height: 26px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 20%, #f97316, #e11d48 55%, #4f46e5);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 25px rgba(248, 113, 113, 0.45);
            font-size: 14px;
        }

        .brand-title {
            font-size: clamp(28px, 3.1vw, 34px);
            font-weight: 700;
            line-height: 1.15;
        }

        .brand-title span {
            color: #f97316;
        }

        .brand-subtitle {
            max-width: 430px;
            font-size: 14px;
            color: #9ca3af;
        }

        .tagline-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 4px;
        }

        .tagline-chip {
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.45);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: #e5e7eb;
            backdrop-filter: blur(12px);
            background-color: rgba(15, 23, 42, 0.75);
        }

        .poster-row {
            display: flex;
            gap: 10px;
            margin-top: 18px;
        }

        .poster {
            flex: 1;
            aspect-ratio: 2 / 3;
            border-radius: 14px;
            background-size: cover;
            background-position: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 35px rgba(0, 0, 0, 0.6);
        }

        .poster::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(15, 23, 42, 0.96), transparent 55%);
        }

        .poster-info {
            position: absolute;
            inset-inline: 10px;
            bottom: 10px;
            z-index: 1;
        }

        .poster-title {
            font-size: 13px;
            font-weight: 600;
        }

        .poster-tag {
            margin-top: 4px;
            font-size: 11px;
            color: #d1d5db;
        }

        .poster-1 {
            background-image: url("https://image.tmdb.org/t/p/w500/9TEJXta9Jjd26jKV4wLGYzFPYfC.jpg");
        }

        .poster-2 {
            background-image: url("https://image.tmdb.org/t/p/w500/bcERImYVxN8pPMP4RPgCvm91vB.jpg");
        }

        .poster-3 {
            background-image: url("https://image.tmdb.org/t/p/w500/ixZdcct8F7zfMDfUYFhXTR2iCpL.jpg");
        }

        .register-container {
            background: radial-gradient(circle at 0 0, rgba(148, 163, 184, 0.28), transparent 55%),
            radial-gradient(circle at 100% 100%, rgba(59, 130, 246, 0.3), transparent 55%),
            rgba(15, 23, 42, 0.96);
            padding: 30px 28px 26px;
            width: 340px;
            border-radius: 18px;
            box-shadow:
                    0 0 0 1px rgba(148, 163, 184, 0.35),
                    0 18px 45px rgba(15, 23, 42, 0.95);
            text-align: left;
            backdrop-filter: blur(22px);
        }

        .register-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 18px;
        }

        .register-header h2 {
            margin: 0;
            font-size: 20px;
        }

        .register-caption {
            margin: 0;
            margin-top: 4px;
            font-size: 13px;
            color: #9ca3af;
        }

        .badge {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 11px;
            background: rgba(59, 130, 246, 0.15);
            border: 1px solid rgba(96, 165, 250, 0.65);
            color: #bfdbfe;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .badge-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: #38bdf8;
            box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.4);
        }

        form {
            margin-top: 8px;
        }

        .field {
            margin-bottom: 12px;
        }

        .field-label {
            font-size: 12px;
            margin-bottom: 5px;
            color: #d1d5db;
        }

        input {
            width: 100%;
            padding: 9px 11px;
            margin: 0;
            box-sizing: border-box;
            border-radius: 10px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background-color: rgba(15, 23, 42, 0.9);
            color: #e5e7eb;
            font-size: 13px;
            outline: none;
            transition: border-color 0.18s ease, box-shadow 0.18s ease, background-color 0.18s ease;
        }

        input::placeholder {
            color: #6b7280;
        }

        input:focus {
            border-color: #f97316;
            box-shadow: 0 0 0 1px rgba(249, 115, 22, 0.65), 0 0 0 10px rgba(249, 115, 22, 0.1);
            background-color: rgba(15, 23, 42, 1);
        }

        button {
            width: 100%;
            padding: 11px;
            margin-top: 8px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border: none;
            color: white;
            font-size: 14px;
            cursor: pointer;
            border-radius: 999px;
            font-weight: 600;
            letter-spacing: 0.03em;
            text-transform: uppercase;
            box-shadow:
                    0 12px 25px rgba(34, 197, 94, 0.5),
                    0 0 0 1px rgba(34, 197, 94, 0.55);
            transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.12s ease;
        }

        button:hover {
            filter: brightness(1.05);
            transform: translateY(-1px);
            box-shadow:
                    0 16px 30px rgba(34, 197, 94, 0.7),
                    0 0 0 1px rgba(34, 197, 94, 0.8);
        }

        button:active {
            transform: translateY(0);
            box-shadow:
                    0 8px 18px rgba(34, 197, 94, 0.5),
                    0 0 0 1px rgba(34, 197, 94, 0.8);
        }

        .helper-row {
            margin-top: 10px;
            font-size: 11px;
            color: #9ca3af;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .helper-row a {
            color: #f97316;
            text-decoration: none;
            font-weight: 500;
        }

        .helper-row a:hover {
            text-decoration: underline;
        }

        #msg {
            margin-top: 12px;
            font-size: 12px;
            min-height: 16px;
            color: #fbbf24;
        }
    </style>
</head>
<body>

<div class="backdrop-blur"></div>

<div class="register-wrapper">
    <section class="brand-section">
        <div class="brand-logo">
            <span>MZ</span>
            <span>MovieZone</span>
        </div>
        <h1 class="brand-title">
            Tạo tài khoản<br/>
            để không bỏ lỡ bất kỳ bộ phim hot nào.
        </h1>
        <p class="brand-subtitle">
            Đăng ký miễn phí, nhận OTP qua email và bắt đầu lưu danh sách yêu thích, lịch sử xem của riêng bạn.
        </p>

        <div class="tagline-chips">
            <div class="tagline-chip">Miễn phí tạo tài khoản</div>
            <div class="tagline-chip">Cá nhân hóa đề xuất</div>
            <div class="tagline-chip">Xem trên mọi thiết bị</div>
        </div>

        <div class="poster-row">
            <article class="poster poster-1">
                <div class="poster-info">
                    <div class="poster-title">Midnight Rail</div>
                    <div class="poster-tag">Trinh thám · 2025</div>
                </div>
            </article>
            <article class="poster poster-2">
                <div class="poster-info">
                    <div class="poster-title">Skyline Dreams</div>
                    <div class="poster-tag">Lãng mạn · Drama</div>
                </div>
            </article>
            <article class="poster poster-3">
                <div class="poster-info">
                    <div class="poster-title">Pixel Wars</div>
                    <div class="poster-tag">Hành động · Game</div>
                </div>
            </article>
        </div>
    </section>

    <section class="register-container">
        <div class="register-header">
            <div>
                <h2>Đăng ký tài khoản</h2>
                <p class="register-caption">Nhập email để nhận mã OTP xác thực.</p>
            </div>
            <div class="badge">
                <span class="badge-dot"></span>
                Bảo mật OTP
            </div>
        </div>

        <!-- FORM REGISTER -->
        <div id="registerSection">
            <form id="registerForm">
                <div class="field">
                    <div class="field-label">Email</div>
                    <input type="email" id="email" placeholder="Nhập email của bạn" required>
                </div>
                <div class="field">
                    <div class="field-label">Username</div>
                    <input type="text" id="username" placeholder="Nhập username" required>
                </div>
                <div class="field">
                    <div class="field-label">Mật khẩu</div>
                    <input type="password" id="password" placeholder="Tối thiểu 6 ký tự" required>
                </div>
                <button type="submit">Gửi mã OTP</button>
            </form>
        </div>

        <!-- FORM VERIFY OTP -->
        <div id="otpSection" style="display:none; margin-top: 10px;">
            <div class="field-label">Nhập mã OTP đã gửi về email</div>
            <form id="verifyForm">
                <div class="field">
                    <input type="text" id="otp" placeholder="Nhập OTP" required>
                </div>
                <button type="submit">Xác nhận OTP</button>
            </form>
        </div>

        <p id="msg"></p>

        <div class="helper-row">
            <span>Đã có tài khoản? <a href="login.html">Đăng nhập</a></span>
        </div>
    </section>
</div>
<script>

    let savedEmail = "";

    // REGISTER
    document.getElementById("registerForm").addEventListener("submit", async e => {

        e.preventDefault();

        const username = document.getElementById("username").value;
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;

        savedEmail = email;

        const res = await fetch("/api/auth/register", {

            method: "POST",

            headers: {
                "Content-Type": "application/json"
            },

            body: JSON.stringify({
                username,
                email,
                password
            })

        });

        const data = await res.json();

        if (res.ok) {

            document.getElementById("msg").style.color = "#22c55e";
            document.getElementById("msg").innerText =
                data.message;

            document.getElementById("registerSection").style.display =
                "none";

            document.getElementById("otpSection").style.display =
                "block";

        } else {

            document.getElementById("msg").style.color = "#ef4444";
            document.getElementById("msg").innerText =
                data.message;
        }

    });


    // VERIFY OTP
    document.getElementById("verifyForm").addEventListener("submit", async e => {

        e.preventDefault();

        const otp = document.getElementById("otp").value;

        const res = await fetch("/api/auth/verify", {

            method: "POST",

            headers: {
                "Content-Type": "application/json"
            },

            body: JSON.stringify({
                email: savedEmail,
                otp
            })

        });

        const data = await res.json();

        if (res.ok) {

            document.getElementById("msg").style.color = "#22c55e";
            document.getElementById("msg").innerText =
                data.message;

        } else {

            document.getElementById("msg").style.color = "#ef4444";
            document.getElementById("msg").innerText =
                data.message;
        }

    });

</script>

</body>
</html>